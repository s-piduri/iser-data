---
title: "ISER Data Section"
author: "Office of Reserach, Planning and Institutional Effectiveness"
date: "`r Sys.Date()`"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)

load("../is_standards.RData")
load("../jobs.RData")
```

# Introduction

## College History

[Provide a brief history of the institution, including year of establishment. Highlight major events or developments that have occurred since the last comprehensive review.]

## Student Enrollment Data 

[Provide tables/charts summarizing enrollment trends. Disaggregate the data as appropriate for the institution’s mission and service area. Provide brief context if needed.] 

## Labor Market Data 

[Provide summary-level labor market data for the service area. Disaggregate the data as appropriate for the institution’s mission and service area. Provide brief context if needed.] 

## Demographic Data 

[Provide summary-level demographic data for the service area. Disaggregate the data as appropriate for the institution’s mission and service area. Provide brief context if needed.] 

```{r}
projections %>% 
  pivot_wider(names_from = years, values_from = population) %>% 
  flextable::flextable()
```

```{r}
raceproj %>% 
  flextable::flextable() %>% 
  flextable::add_header_lines(values = "Bay Area Population Projections by Race/Ethnicity") %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::set_formatter("2020" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2060" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("Change" = function(x) sprintf("%.001f%%", x*100))

```



```{r}
race %>% flextable::flextable() %>% 
    flextable::add_header_lines(values = "Service Area Racial Breakdown") %>% 
    flextable::align(i=1, align="center", part="header") %>%
    flextable::set_formatter("Bay Area: Percent" = function(x) sprintf("%.001f%%", x*100)) %>% 
    flextable::set_formatter("SC County: Percent" = function(x) sprintf("%.001f%%", x*100))  
```

```{r}
  ethnicity %>% flextable::flextable() %>% 
    flextable::add_header_lines(values = "Service Area Ethnicity Breakdown") %>% 
    flextable::align(i=1, align="center", part="header") %>%
    flextable::set_formatter("Bay Area: Percent" = function(x) sprintf("%.001f%%", x*100)) %>% 
    flextable::set_formatter("SC County: Percent" = function(x) sprintf("%.001f%%", x*100))
     
```

```{r}
education %>% flextable::flextable() %>% 
    flextable::add_header_lines(values = "Educational Attainment for Population 25+") %>% 
    flextable::align(i=1, align="center", part="header") %>%
    flextable::set_formatter("Bay Area: Percent" = function(x) sprintf("%.001f%%", x*100)) %>% 
    flextable::set_formatter("SC County: Percent" = function(x) sprintf("%.001f%%", x*100))
```


## Socio-economic Data 

[Provide summary-level socio-economic data for the service area. Disaggregate the data as appropriate for the institution’s mission and service area. Provide brief context if needed.] 

## Sites 

[List names and locations (including addresses) of sites where 50% or more of a program, certificate, or degree is available to students, and any other off-campus sites or centers.] 

## Specialized or Programmatic Accreditation 

[Provide a list of any specialized or programmatic accreditations held by the institution.] 

# Presentation of Student Achievement Data and Institution-Set Standards 

## Course Success Rates

```{r}
title <- overallcs$title[1]
desc <- overallcs$description[1]
overallcs %>% 
  select(years, type, percentage) %>% 
  pivot_wider(names_from = years, values_from = percentage) %>% 
  flextable::flextable() %>% 
  flextable::add_header_lines(values = title) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::set_formatter("2016-2017" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2017-2018" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2018-2019" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2019-2020" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1) 
```
##Number of Certificate Earners
```{r}
title <- "Distinct number of CO-approved certificate earners (12+ units)"
overall603 %>% 
  select(years, type, value) %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::add_header_lines(values = title) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width=1)
```

##Number of Degree Earners (ADT, AS, AA)
```{r}
title <- "Distinct number of degree earners (AA, AS, or ADT) "
overall631 %>% 
  select(years, type, value) %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::add_header_lines(values = title) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width = 1)
```
##Number of transfer degree earners
```{r}
title <- "Distinct number of ADT earners"
overall608 %>% 
  select(years, type, value) %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::add_header_lines(values = title) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width = 1)
```

##Transfers to CSU or UC
```{r}
title <- "Distinct number of transfers to CSU or UC"
overall614 %>% 
  select(years, type, value) %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::add_header_lines(values = title) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width = 1)
```
##Disaggregation by Gender
###Course success
```{r}
title <- "Course Success Rates by Gender"
desc <- "Note that \"All Masked Values\" contains Non-Binary and Unknown/Non-Respondent students."
csgender %>% 
  select(years, subgroup, perc) %>% 
  drop_na() %>% 
  pivot_wider(names_from = years, values_from = perc) %>% 
  flextable::flextable() %>% 
  flextable::add_header_lines(values = title) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::set_formatter("2016-2017" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2017-2018" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2018-2019" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2019-2020" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1.2) 
  
```
###Certificate Earners by Gender
```{r}
title <- "Certificate Earners by Gender"
desc <- "Note that \"All Masked Values\" contains Non-Binary and Unknown/Non-Respondent students."
ggrads603 %>% 
  select(years, subgroup, value) %>% 
  drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::add_header_lines(values = title) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width=1) %>% 
  flextable::add_footer_lines(values = desc)
```


###Degree Earners by Gender
```{r}
title <- "Degree Earners by Gender"
desc <- "Note that \"All Masked Values\" contains Non-Binary and Unknown/Non-Respondent students."
ggrads631%>% 
  select(years, subgroup, value) %>% 
  drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::add_header_lines(values = title) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1)
```

###Transfer Earners by Gender
```{r}
title <- "ADT Earners by Gender"
desc <- "Note that \"All Masked Values\" contains Non-Binary and Unknown/Non-Respondent students."
ggrads608%>% 
  select(years, subgroup, value) %>% 
  drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::add_header_lines(values = title) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1)
```

###CSU/UC Transfers by Gender
```{r}
title <- "Distinct Number of Transfers to CSU or UC by Gender"
desc <- "Note that \"All Masked Values\" contains Non-Binary and Unknown/Non-Respondent students."
ggrads614 %>% 
  select(years, subgroup, value) %>% 
  filter(subgroup=="Female" | subgroup=="Male" | subgroup=="All Masked Values") %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::add_header_lines(values = title) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1)
```




##Disaggregation by Ethnicity
###Course success
```{r}
title <- "Course Success Rates by Ethnicity"
desc <- "Note that \"All Masked Values\" contains students who listed multiple values or did not respond."
csrace %>% 
  select(years, subgroup, perc) %>% 
  pivot_wider(names_from = years, values_from = perc) %>% 
  drop_na() %>% 
  flextable::flextable() %>% 
  flextable::add_header_lines(values = title) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::set_formatter("2016-2017" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2017-2018" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2018-2019" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2019-2020" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1.2) 
  
```
###Certificate Earners by Ethnicity
```{r}
title <- "Certificate Earners by Ethnicity"
desc <- "Note that \"All Masked Values\" contains students who listed multiple values or did not respond."
rgrads603 %>% 
  select(years, subgroup, value) %>% 
  #drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::add_header_lines(values = title) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width=1) %>% 
  flextable::add_footer_lines(values = desc)
```


###Degree Earners by Ethnicity
```{r}
title <- "Degree Earners by Ethnicity"
desc <- "Note that \"All Masked Values\" contains students who listed multiple values or did not respond."
rgrads631%>% 
  select(years, subgroup, value) %>% 
  #drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::add_header_lines(values = title) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1)
```

###Transfer Earners by Ethnicity
```{r}
title <- "ADT Earners by Ethnicity"
desc <- "Note that \"All Masked Values\" contains students who listed multiple values or did not respond."
rgrads608%>% 
  select(years, subgroup, value) %>% 
  #drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::add_header_lines(values = title) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1)
```

###CSU/UC Transfers by Ethnicity
```{r}
title <- "Distinct Number of Transfers to CSU or UC by Ethnicity"
desc <- "Note that \"All Masked Values\" contains students who listed multiple values or did not respond."
rgrads614 %>% 
  select(years, subgroup, value) %>% 
  #drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::add_header_lines(values = title) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1)
```

##Licensure Pass and Job Placement Rates
```{r licensure}
  licensure %>% 
  flextable::flextable()

```

```{r job placement}
  jobplace %>% flextable::flextable()
```



# Examples below

## Including Table

```{r cars}
cars %>% 
  slice_head(n=10) %>%
  flextable::flextable()
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
