---
title: "ISER Data Section"
author: "Office of Reserach, Planning and Institutional Effectiveness"
date: "`r Sys.Date()`"
output: word_document
    
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(flextable)
library(officer)

load("../is_standards.RData")
load("../entable.RData")
load("../jobs.RData")
load("../demo.RData")
load("../labor_data.RData")
set_flextable_defaults(font.size = 9)

```


# Introduction

## College History

[Provide a brief history of the institution, including year of establishment. Highlight major events or developments that have occurred since the last comprehensive review.]

## Student Enrollment Data 

### Overall Enrollment Trend

The college's overall enrollment, using any enrollment metrics (headcount, seatcount or full-time equivalent students (FTES)), has declined in the last 5 years after a small increase in 2018-2019. Given the impact of COVID-19 pandemic and the statewide enrollment decline, this is not surprising.

Specifically, overall headcount has declined 16% from 2017-18 to 2021-22. This decline is reflected throughout the enrollment trend data.

>>>>> Calculate the percentage decline from 2017-18 for headcount and talk about that.

```{r, ft.align='left'}
annual %>% 
    filter(Metric == "Overall:" | Metric == "Credit Students:" | Metric == "Noncredit Students:" | Metric == "Headcount") %>% 
  flextable() %>% 
  set_caption("Annual Student Metrics", 
              autonum = run_autonum(seq_id='tab', bkm='hc')) %>% 
  footnote(j=1, value=as_paragraph("Source: SJCC Internal Data Warehouse"),
           ref_symbols=c(""), part = "header") %>% 
  width(j=1, width=2) %>% 
  #if including ftes and sc, these five lines need to be used so that they affect the subheadings
  # surround(i = 5, part = 'body', border.top = fp_border()) %>% 
  # surround(i = 9, part = 'body', border.top = fp_border()) %>% 
  # bold(i=1, part='body') %>% 
  # bold(i=5, part='body') %>%
  # bold(i=9, part='body') %>% 
  surround(i = 3, part = 'body', border.top = fp_border()) %>% 
  surround(i = 5, part = 'body', border.top = fp_border()) %>% 
  bold(i=1, part='body') %>% 
  bold(i=3, part='body') %>%
  bold(i=5, part='body') %>% 
  footnote(j=1, value=as_paragraph("A student is counted as credit/noncredit if they take at least one course in that type. Note that some students enroll in both credit and noncredit courses during the academic year, so they are included in both the credit and noncredit figures. Because of this, the sum of credit and noncredit headcounts does not equal the overall headcount."),
           ref_symbols=c(""), part = "header")
#### have the seatcount and FTES ready, but remove from the discussion here. We may put them back in later. Let me know if you have any questions on this.
```



### Credit Enrollment Trends and Student Composition

>>>>> let's separate out credit and noncredit. in this section only focus on credit students and their breakdown
>>>>> decribe the 5 year trend using 5yr %change, which sets the reference decline for examining all groups.
>>>>> add the average at the end here.

This section describes the credit enrollment trends by various student attributes. Data are from Fall terms between Fall 2017 and Fall 2021. It includes all students enrolled in at least one credit course. The data are extracted from the district's internal database by the Office of Research, Planning and Institutional Effectiveness. 

>>>> insert discussion of 5 year trend here.

```{r, ft.align='left'}
fall_hc %>% 
  flextable() %>% 
  set_caption("Unduplicated Overall Headcount, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='fhc')) %>% 
  footnote(j=1, value=as_paragraph("Source: SJCC Internal Data Warehouse"),
           ref_symbols=c(""), part = "header") %>% 
  width(width=1)
```
>>>> Describe the trend you see here in a plain straightforward language. For example, "In Fall terms, xx percent of credit students are y type, xx percent are z type, etc. any other noteworthy obvious trends.

On average, 62% of credit students are continuing students in Fall terms. While enrollment has decreased, the percentage of continuing students enrolled in credit classes has increased, going from 57%. 
Nearly 17% of credit students are new students, and 12% of credit students are returning students. Approximately 8% percent of credit students are K-12 students dual-enrolled in college courses.  

```{r, ft.align='left'}
fall_type %>% 
  flextable() %>% 
  set_caption("Unduplicated Headcount by Student Type, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='fthc')) %>% 
  footnote(j=1, value=as_paragraph("Source: SJCC Internal Data Warehouse"),
           ref_symbols=c(""), part = "header") %>%
  width(j=1, width=1.3) %>% 
  width(j=7, width=1) %>% 
  align(j=c(2:7), align = 'right', part = 'all')

```

Earning an AA degree for transfer to a four-year college is the most common educational goal among credit students in Fall terms, with 40% of credit students listing this as their primary educational goal. Around 11% of students stated their goal was to transfer to a four-year college without an AA, and another 10% were undecided on their goal. 
Around 50% of students plan on transferring to a four-year college with or without an AA degree. Similarly, around 48% of credit students plan on earning an AA degree regardless of whether they transfer to a four-year college.


```{r, ft.align='left'}
fall_goal %>% 
  #pivot_wider(names_from="Fall Term", values_from = "Headcount") %>% 
  flextable() %>% 
  set_caption("Unduplicated Credit Headcount by Student Goal, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='fghc')) %>% 
  footnote(j=1, value=as_paragraph("Source: SJCC Internal Data Warehouse"),
           ref_symbols=c(""), part = "header") %>% 
  width(j=1, width=2) %>% 
  align(j=c(2:7), align = 'right', part = 'all')
```

The majority of credit students across all five years were female, with an average population of 57% female students and 42% male students. 
The percentage of female students has risen 5 percent in the past five years, while the percentage of male students has dropped.

```{r, ft.align='left'}
fall_gender %>% 
  #pivot_wider(names_from="Fall Term", values_from = "Headcount") %>% 
  flextable() %>% 
  set_caption("Unduplicated Credit Headcount by Gender, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='fgehc')) %>% 
  footnote(j=1, value=as_paragraph("Source: SJCC Internal Data Warehouse"),
           ref_symbols=c(""), part = "header") %>% 
  width(j=7, width=1.1) %>% 
  align(j=c(2:7), align = 'right', part = 'all')
```

Approximately 45% of credit students in Fall terms were Latinx. This has remained constant throughout the past five years. The percentage of Asian credit students has slightly increased from 23% in 2017 to 27% in 2021. Likewise, the percentage of white credit students has decreased from 14% to 11%. The percentage of Black credit students has stayed steady at around 5% over the past five years.  

```{r, ft.align='left'}
fall_race %>% 
  #pivot_wider(names_from="Fall Term", values_from = "Headcount") %>% 
  flextable() %>% 
  set_caption("Unduplicated Credit Headcount by Race/Ethnicity, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='frhc')) %>% 
  footnote(j=1, value=as_paragraph("Source: SJCC Internal Data Warehouse"),
           ref_symbols=c(""), part = "header") %>% 
  width(j=1, width=1.6) %>% 
  align(j=c(2:7), align = 'right', part = 'all')
```

Around 46% of credit students in Fall terms are between the ages of 18 and 24. Then, 33% of credit students are between 25 and 39. While nearly 80% of credit students between 18 and 39 years old, there are also sizable populations of students over 40 and under 18.

```{r, ft.align='left'}
fall_age %>% 
  #pivot_wider(names_from="Fall Term", values_from = "Headcount") %>% 
  flextable() %>% 
  set_caption("Unduplicated Credit Headcount by Age, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='fahc')) %>% 
  footnote(j=1, value=as_paragraph("Source: SJCC Internal Data Warehouse"),
           ref_symbols=c(""), part = "header") %>% 
  width(j=1, width=.8) %>% 
  width(j=7, width=1) %>% 
  align(j=c(2:7), align = 'right', part = 'all')
```
The largest special population served by SJCC is First Generation college students, who made up xx% of the total headcount of the past 5 years on average.  


```{r, ft.align='left'}
sp_hc %>% flextable() %>% 
  set_caption("Unduplicated Headcount of Special Populations, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='special')) %>% 
  footnote(j=1, value=as_paragraph("Source: CCC Chancellor's Office Data Mart"),
           ref_symbols=c(""), part = "header") %>% 
  width(j=1, width=3)
```
### Noncredit Enrollment Trends and Student Composition

>>>>> for noncredit, only disaggregate by gender, race and age.
>>>> Also do this by subject area too where if they take one noncredit course in one subject area, then count that as enrollment in that subject area. The point I want to make is that the biggest program is our noncredit esl.

Female students make up the majority of noncredit students with 67% of the noncredit student population being female over the past five years. In contrast, male students make up only 30% of the noncredit student population.
In Fall 2020, female students comprised almost 75% of the noncredit student population, a 10% increase than the year before. 

```{r, ft.align='left'}
#gender
fall_ncgender %>% 
  flextable() %>% 
  set_caption("Noncredit Headcount by Gender, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='fgehcnc')) %>% 
  footnote(j=1, value=as_paragraph("Source: SJCC Internal Data Warehouse"),
           ref_symbols=c(""), part = "header") %>% 
  width(j=7,width=1.1) %>% 
  align(j=c(2:7), align = 'right', part = 'all')



```
On average, 34% of noncredit students in Fall terms were Asian, while 31% were Latinx. White students made up 15% of the noncredit student population, and Black students comprised around 4% on average.
In Fall 2020, the percentage of noncredit White students rose 12 percent from Fall 2019, while the percentage for noncredit Asian students dropped 10 percent. Similarly, the percentage of Latinx noncredit students dropped around 8 percent from Fall 2018 to Fall 2019. 

```{r, ft.align='left'}
#race
fall_ncrace %>% 
  flextable() %>% 
  set_caption("Noncredit Headcount by Race/Ethnicity, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='frhcnc')) %>% 
  footnote(j=1, value=as_paragraph("Source: SJCC Internal Data Warehouse"),
           ref_symbols=c(""), part = "header") %>% 
  width(j=7,width=1.1) %>% 
  width(j=1,width=1.6) %>% 
  align(j=c(2:7), align = 'right', part = 'all')

```
Students aged 25 to 39 make up 42% of the noncredit student population on average. In contrast with the credit student population, 40% of the noncredit student population is 40 years old or over. In total, over 80% of the noncredit student population is 25 or older. 
Only 15% of the noncredit population is between 18 and 24. 

```{r, ft.align='left'}
#age
fall_ncage %>% 
  flextable() %>% 
  set_caption("Noncredit Headcount by Age, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='fahcnc')) %>% 
  footnote(j=1, value=as_paragraph("Source: SJCC Internal Data Warehouse"),
           ref_symbols=c(""), part = "header") %>% 
  width(j=7,width=1.1) %>% 
  width(j=1,width=.9) %>% 
  align(j=c(2:7), align = 'right', part = 'all')

```
The vast majority of noncredit students are enrolled in ESL classes. 

```{r, ft.align='left'}
#subject area (split crs_name into dept, #)
fall_ncsubject %>% 
  flextable() %>% 
  set_caption("Noncredit Headcount by Subject, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='fahc')) %>% 
  footnote(j=1, value=as_paragraph("Source: SJCC Internal Data Warehouse"),
           ref_symbols=c(""), part = "header") %>% 
  width(j=7,width=1.1) %>% 
  align(j=c(2:7), align = 'right', part = 'all')

```


## Labor Market Data 

At a broad level, the top industries in the Greater Bay Area are Health Care and Social Assistance and Professional, Scientific, and Technical Services.

```{r, ft.align='left'}
broad_ten %>% flextable() %>% 
  flextable::set_formatter("Share of Total Employment" = function(x) sprintf("%.001f%%", x*100)) %>% 
  set_caption("Top Industries by Employment (Greater Bay Area, 2020 Q3)", autonum = run_autonum(seq_id='tab', bkm='broadten')) %>% 
  footnote(j=1, value = as_paragraph("Source: JobsEQ, via Hanover Research"), ref_symbols=c(""), part = "header") %>% 
  width(j=1, width = 4.5) %>% 
  width(j=2, width=2)
```

More than 10 percent of workers are employed in each of these two broad industries. At a more detailed level, employment after restaurants is concentrated in several high tech industries, schools, and hospitals (reference the top industries by employment table). 

```{r, ft.align="left"}
topten %>% flextable::flextable() %>% 
  flextable::set_formatter("Share of Total Employment" = function(x) sprintf("%.001f%%", x*100)) %>% 
  width(j=1, width = 4.5) %>% 
  width(j=2, width=2) %>% 
  set_caption("Top Industries by Employment  (Greater Bay Area, 2020 Q3)", autonum = run_autonum(seq_id='tab', bkm='topten')) %>% 
  footnote(j=1, value = as_paragraph("Source: JobsEQ, via Hanover Research"), ref_symbols=c(""), part = "header")
```

All top 10 Bay Area tech industries by share of employment have positive 10-year projected growth (reference table). Also, the Greater Bay Area is projected to have an employment undersupply for occupations in business, technology, and healthcare including software developers, nurses, and managers while it is also projected to have a slight oversupply for teaching related occupations and paralegals/legal assistants. 


```{r, ft.align='left'}
gaps %>% flextable() %>% 
  width(j=1, width = 5) %>% 
  set_caption("Occupation Gaps over 10 Years in Greater Bay Area, Two-Year Degree or Higher Only", autonum = run_autonum(seq_id='tab', bkm='gaps')) %>% 
  footnote(j=1, value = as_paragraph("Source: JobsEQ, via Hanover Research"), ref_symbols=c(""), part = "header") %>% 
  footnote(j=1, value = as_paragraph("Note that this list only includes occupations that require at minimum a two-year (Associate's) degree. The Gap column illustrates the  number of persons with necessary credentials to work in these field."), ref_symbols=c(""), part = "header")

```

The 

```{r, ft.align="left"}
toptech %>% flextable::flextable() %>% 
  set_caption("Top Bay Area Tech Industries  (Greater Bay Area, 2020 Q3)", autonum = run_autonum(seq_id='tab', bkm='toptech')) %>% 
  flextable::set_formatter("Projected Growth, 2020-2030" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("Share of Total Employment" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_table_properties(width = .5, layout='autofit') %>% 
  footnote(j=1, value = as_paragraph("Source: JobsEQ, via Hanover Research"), ref_symbols=c(""), part = "header")

```



```{r, ft.align="left"}
most_openings %>% select(-"Unemployment") %>% 
  flextable::flextable() %>% 
  set_caption("Occupations with the Most Job Openings", autonum = run_autonum(seq_id='tab', bkm='openings')) %>% 
  flextable::set_table_properties(width = .5, layout='autofit') %>% 
  footnote(j=1, value = as_paragraph("Source: JobsEQ, via Hanover Research"), ref_symbols=c(""), part = "header")

```

```{r, ft.align="left"}
most_growth %>% select(-"Unemployment") %>% 
  flextable::flextable() %>% 
  flextable::set_formatter("% Change" = function(x) sprintf("%.001f%%", x*100)) %>%
  set_caption("Fastest Growing Occupations",autonum = run_autonum(seq_id='tab', bkm='topten')) %>% 
  width(j=1, width = 5) %>% 
  footnote(j=1, value = as_paragraph("Source: JobsEQ, via Hanover Research"), ref_symbols=c(""), part = "header")


```


## Demographic Data 

Population projections indicate strong growth in Santa Clara County as well as the Greater Bay Area. Between 2020 and 2060 projections suggest the Greater Bay Area’s population will increase by 18.2 % Santa Clara County’s population growth is expected to be higher at 23.1%.


```{r, ft.align="left"}
projections %>% 
  pivot_wider(names_from = years, values_from = population) %>% 
  flextable::flextable() %>% 
  set_caption("Bay Area Population Projections", autonum = run_autonum(seq_id='tab', bkm='popproj')) %>% 
  width(width=1.05) %>% 
  footnote(j=1, value = as_paragraph("Source: State of California Department of Finance, via Hanover Research"), ref_symbols=c(""), part = "header")
```
Projections by age group suggest an aging population, though the traditional student age group is expected to remain stable. Projections through 2060 by age group indicate large increases in the share of residents ages 40-44 and 85+, with a small increase in the 35-39 age group. The share of residents below 20 is expected to decline. Ages 20-24, the prime college going population, is expected to remain between 7.6 and 7.7%.

>>>>> can you add the population project by age group here?

```{r, ft.align="left"}
#population projection by age
ageproj %>% 
  flextable() %>% 
  set_caption("Bay Area Population Projections by Age",autonum = run_autonum(seq_id='tab', bkm='aproj')) %>% 
    footnote(j=1, value = as_paragraph("Source: State of California Department of Finance, via Hanover Research"), ref_symbols=c(""), part = "header")


```



Projections suggest an increasingly diverse community in the Greater Bay Area. A Metropolitan Transportation Commission (MTC) report on The Bay Area in 2040 suggests the population will become substantially more racially and ethnically diverse compared to the 2010 Census figures. Hispanic/Latino residents are projected to become the largest ethnic group and significant decline is projected in the White non Hispanic population. The share of Black or African American residents is also expected to decline slightly. Population projections in the Greater Bay Area suggest this trend will continue through 2060 with the share of non-Hispanic Whites dropping by 15.7% while the Asian population increases by 10.2%, and the Hispanic/Latino population grows by 4.8%. The Black non Hispanic population is expected to fall very slightly, by less than one percentage point.


```{r, ft.align="left"}
raceproj %>% 
  flextable::flextable() %>% 
  set_caption("Bay Area Population Projections by Race/Ethnicity",autonum = run_autonum(seq_id='tab', bkm='rproj')) %>% 
  flextable::set_formatter("2020" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2060" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("Percent Change" = function(x) sprintf("%.001f%%", x*100)) %>% 
  width(j=1,width=3) %>% 
  footnote(j=1, value = as_paragraph("Source: State of California Department of Finance, via Hanover Research"), ref_symbols=c(""), part = "header")

```

The Greater Bay Area and the Santa Clara County are relatively diverse, but has a low share of Black or African American residents (5.5% and 2.3%, respectively). In the Greater Bay Area, the largest share of the population is White non Hispanic, while in the Santa Clara County, it is Asian. In both areas, approximately a quarter of residents are Hispanic or Latino (of any race).


```{r, ft.align="left"}
  ethnicity1 %>% flextable() %>% 
   set_caption("Service Area Ethnicity Breakdown, 2019",autonum = run_autonum(seq_id='tab', bkm='ethn')) %>% 
    flextable::set_formatter("Bay Area %" = function(x) sprintf("%.001f%%", x*100)) %>%
    flextable::set_formatter("Santa Clara County %" = function(x) sprintf("%.001f%%", x*100))%>%
    flextable::set_table_properties(width = .5, layout='autofit') %>%
    footnote(j=1, value = as_paragraph("Source: US Census Bureau, via Hanover Research"), ref_symbols=c(""), part = "header") %>% 
  footnote(j=1, value = as_paragraph("Note: SJCC Headcount data is the annual 2020-2021 overall headcount."), ref_symbols=c(""), part = "header")

#### please note the year of the data. -done
#### order based on the bay area percentage
### can you check that the white alone actually means white alone, not hispanic or Latino? - it does
#### let's add the 2020-2021 annual headcount (both credit and noncredit) by ethnicity as another column both n and %. Add a note below that says it is from 2020-2021 data. 


```




## Socio-economic Data 

On the whole, the Greater Bay Area and Santa Clara County is well-educated. More than a quarter of Greater Bay Area residents hold a bachelor’s degree, with nearly 20 % holding a graduate or professional degree. A small share holds associate’s degrees, but it is unclear how many bachelor’s degree holders initially pursued an associate’s program before transfer. However, over 40% of Santa Clara County residents aged 25 or older hold less than associate degree.  

```{r, ft.align="left"}
education1 %>% 
  
  flextable::flextable() %>% 
  set_caption("Educational Attainment for Population Age 25+, 2019",autonum = run_autonum(seq_id='tab', bkm='edatt')) %>% 
  flextable::set_formatter("Bay Area: Percent" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("Santa Clara County: Percent" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_table_properties(width = .5, layout='autofit') %>% 
  footnote(j=1, value = as_paragraph("Source: US Census Bureau, via Hanover Research"), ref_symbols=c(""), part = "header") %>% 
  surround(i = 9, part = 'body', border.top = fp_border(width = 1.2))

#### for total, use 100% instead of NA%. Also, add "Total" before the word population for the first row. -done

#### use a row separater to mark the last 2 rows in a way similar to Santa Barabara did it. As it is, it is a bit hard to understand what the last 2 rows are doing. I want to see a line or a row above high school separating the last 2 rows from the rest. - done

### is this data available by race if you go to census? If available, can you write a paragraph which population are experiencing lower educational attainment?

### add year information - done



```


```{r, ft.align="left"}
median1 %>% 
  flextable::flextable() %>% 
  set_caption("Household Income in the Service Area",autonum = run_autonum(seq_id='tab', bkm='income')) %>% 
  width(width=1.5) %>% 
    footnote(j=1, value = as_paragraph("Source: US Census Bureau (American Community Survey, 2014-2018), via Hanover Research"), ref_symbols=c(""), part = "header")

#### can  you make sure that the SC county data also goes down to the 2 decimal places. If unavailable, get rid of it for other columns too. - done


#### can you get this sort of income data by race to illustrate the income gap?
### also can you find out if by income we mean household income? - done


```


```{r, ft.align='left'}
poverty %>% flextable() %>%
    flextable::set_formatter("Greater Bay Area" = function(x) sprintf("%.001f%%", x*100)) %>% 
    flextable::set_formatter("Santa Clara County" = function(x) sprintf("%.001f%%", x*100)) %>% 
    set_caption("Poverty Level in the Service Area",autonum = run_autonum(seq_id='tab', bkm='poverty')) %>% 
  width(width=1.5) %>% 
  footnote(j=1, value = as_paragraph("Source: US Census Bureau, via Hanover Research"), ref_symbols=c(""), part = "header")


###also is this data available by race? - yes

```


```{r}
#poverty by race
poverty_race1 %>% 
  flextable() %>% 
  set_caption("Poverty Level by Race in the Service Area",autonum = run_autonum(seq_id='tab', bkm='rpoverty')) %>% 
  width(j= 1, width=3.5) %>% 
  footnote(j=1, value = as_paragraph("Source: US Census Bureau, via Hanover Research"), ref_symbols=c(""), part = "header") %>% 
  align(j=c(2:3), align='right', part='all')
```


## Sites 

[List names and locations (including addresses) of sites where 50% or more of a program, certificate, or degree is available to students, and any other off-campus sites or centers.] 

## Specialized or Programmatic Accreditation 

[Provide a list of any specialized or programmatic accreditations held by the institution.] 

# Presentation of Student Achievement Data and Institution-Set Standards 


```{r, ft.align='left'}
desc <- overallcs$description[1]
overallcs %>% 
  select(years, Type, percentage) %>% 
  pivot_wider(names_from = years, values_from = percentage) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::set_formatter("2016-2017" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2017-2018" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2018-2019" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2019-2020" = function(x) sprintf("%.001f%%", x*100)) %>% 
  width(width = 1.3) %>% 
  align(j=1, align= "left", part = "all") %>% 
  align(j=2:5, align = "right", part = "all") %>% 
  set_caption("Overall Course Success Rate",autonum = run_autonum(seq_id='tab', bkm='cso')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```

```{r, ft.align='left'}
title <- "Distinct number of CO-approved certificate earners (12+ units)"
overall603 %>% 
  select(years, Type, value) %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width=1.3) %>% 
  align(j=1, align= "left", part = "all") %>% 
  align(j=2:5, align = "right", part = "all") %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='cert')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```


```{r, ft.align='left'}
title <- "Distinct number of degree earners (AA, AS, or ADT) "
overall631 %>% 
  select(years, Type, value) %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>%
  align(j=1, align= "left", part = "all") %>% 
  align(j=2:5, align = "right", part = "all") %>% 
  flextable::width(width=1.3) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='deg')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")
```

```{r, ft.align='left'}
title <- "Distinct number of ADT earners"
overall608 %>% 
  select(years, Type, value) %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width=1.3) %>%
  align(j=1, align= "left", part = "all") %>% 
  align(j=2:5, align = "right", part = "all") %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='adt')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```


```{r, ft.align='left'}
title <- "Distinct number of transfers to CSU or UC"
overall614 %>% 
  select(years, Type, value) %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width=1.1) %>% 
  align(j=1, align= "left", part = "all") %>% 
  align(j=2:6, align = "right", part = "all") %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='csuuc')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")
```
## Disaggregation by Gender


```{r, ft.align='left'}
title <- "Course Success Rates by Gender"
desc <- "Note: \"All Masked Values\" contains Non-Binary and Unknown/Non-Respondent students."
csgender %>% 
  select(years, Gender, value) %>% 
  drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::set_formatter("2016-2017" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2017-2018" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2018-2019" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2019-2020" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::add_footer_lines(values = desc) %>% 
  align(j=1, align= "left", part = "all") %>% 
  align(j=2:5, align = "right", part = "all") %>% 
  flextable::width(width=1.3) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='csg')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")
```

```{r, ft.align='left'}
title <- "Certificate Earners by Gender"
desc <- "Note: \"All Masked Values\" contains Non-Binary and Unknown/Non-Respondent students."
ggrads603 %>% 
  select(years, Gender, value) %>% 
  drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width=1.3) %>% 
  align(j=1, align= "left", part = "all") %>% 
  align(j=2:5, align = "right", part = "all") %>% 
  flextable::add_footer_lines(values = desc) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='certg')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```


```{r, ft.align='left'}
title <- "Degree Earners by Gender"
desc <- "Note: \"All Masked Values\" contains Non-Binary and Unknown/Non-Respondent students."
ggrads631%>% 
  select(years, Gender, value) %>% 
  drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1.3) %>% 
  align(j=1, align= "left", part = "all") %>% 
  align(j=2:5, align = "right", part = "all") %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='degg')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```

```{r, ft.align='left'}
title <- "ADT Earners by Gender"
desc <- "Note: \"All Masked Values\" contains Non-Binary and Unknown/Non-Respondent students."
ggrads608%>% 
  select(years, Gender, value) %>% 
  drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1.3) %>% 
  align(j=1, align= "left", part = "all") %>% 
  align(j=2:5, align = "right", part = "all") %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='adtg')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```


```{r, ft.align='left'}
title <- "Distinct Number of Transfers to CSU or UC by Gender"
desc <- "Note: \"All Masked Values\" contains Non-Binary and Unknown/Non-Respondent students."
ggrads614 %>% 
  select(years, Gender, value) %>% 
  filter(Gender=="Female" | Gender=="Male" | Gender=="All Masked Values") %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1.075) %>% 
  align(j=1, align= "left", part = "all") %>% 
  align(j=2:6, align = "right", part = "all") %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='csuucg')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```
## Disaggregation by Ethnicity

```{r, ft.align='left'}
title <- "Course Success Rates by Ethnicity"
desc <- "Note: \"All Masked Values\" contains students who listed another ethnicity or did not respond."
csrace %>% 
  select(years, Ethnicity, value) %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  drop_na() %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::set_formatter("2016-2017" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2017-2018" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2018-2019" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2019-2020" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(j=1, width=2.1) %>% 
  align(j=1, align= "left", part = "all") %>% 
  align(j=2:5, align = "right", part = "all") %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='cse')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```


```{r, ft.align='left'}
title <- "Certificate Earners by Ethnicity"
desc <- "Note: \"All Masked Values\" contains students who listed another ethnicity or did not respond."
rgrads603 %>% 
  select(years, Ethnicity, value) %>% 
  #drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(j=1, width=2.1) %>% 
  width(j=2:5, width = 1) %>% 
  flextable::add_footer_lines(values = desc) %>% 
  align(j=1, align= "left", part = "all") %>% 
  align(j=2:5, align = "right", part = "all") %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='certe')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")
```


```{r, ft.align='left'}
title <- "Degree Earners by Ethnicity"
desc <- "Note: \"All Masked Values\" contains students who listed another ethnicity or did not respond."
rgrads631%>% 
  select(years, Ethnicity, value) %>% 
  #drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(j=1, width=2.2) %>% 
  width(j=2:5, width = 1) %>% 
  flextable::add_footer_lines(values = desc) %>% 
  align(j=1, align= "left", part = "all") %>% 
  align(j=2:5, align = "right", part = "all") %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='dege')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")
```


```{r, ft.align='left'}
title <- "ADT Earners by Ethnicity"
desc <- "Note: \"All Masked Values\" contains students who listed another ethnicity or did not respond."
rgrads608%>% 
  select(years, Ethnicity, value) %>% 
  #drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(j=1, width=2.3) %>% 
  width(j=2:5, width = 1) %>% 
  flextable::add_footer_lines(values = desc) %>% 
  align(j=1, align= "left", part = "all") %>% 
  align(j=2:5, align = "right", part = "all") %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='adte')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```


```{r, ft.align='left'}
title <- "Distinct Number of Transfers to CSU or UC by Ethnicity"
desc <- "Note: \"All Masked Values\" contains students who listed another ethnicity or not respond."
rgrads614 %>% 
  select(years, Ethnicity, value) %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(j=1, width=2.2) %>% 
  flextable::add_footer_lines(values = desc) %>% 
  align(j=1, align= "left", part = "all") %>% 
  align(j=2:6, align = "right", part = "all") %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='csuuce')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```

## Licensure Pass and Job Placement Rates

```{r licensure, ft.align='left'}
licensure %>% 
  select("Program", "Exam Type", "Institution Set Standard", "Stretch Goal", 
         "2016-2017", "2017-2018", "2018-2019", "2019-2020", "2020-2021") %>% 
  flextable::flextable() %>% 
  flextable::set_table_properties(width = .5, layout='autofit') %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::set_formatter("Institution Set Standard" = function(x) sprintf("%.001f%%", x*100)) %>%
  flextable::set_formatter("Stretch Goal" = function(x) sprintf("%.000f%%", x*100)) %>%
  flextable::set_formatter("2016-2017" = function(x) sprintf("%.000f%%", x*100)) %>% 
  flextable::set_formatter("2017-2018" = function(x) sprintf("%.000f%%", x*100)) %>% 
  flextable::set_formatter("2018-2019" = function(x) sprintf("%.000f%%", x*100)) %>% 
  flextable::set_formatter("2019-2020" = function(x) sprintf("%.000f%%", x*100)) %>% 
  flextable::set_formatter("2020-2021" = function(x) sprintf("%.000f%%", x*100)) %>% 
  footnote(i=4, j=8, value = as_paragraph("No campus specific data on this item."), ref_symbols = c("A"), part = "body") %>%  
  footnote(i=5, j=8, value = as_paragraph("No one took the exam this year due to Covid"), ref_symbols = c("B"), part = "body") %>% 
  set_caption("Licensure Pass Rates", autonum = run_autonum(seq_id='tab', bkm='cert')) %>%
  footnote(j=1, value = as_paragraph("Source: ACCJC Annual Reports"), ref_symbols=c(""), part = "header")


```


```{r job placement, ft.align='left'}
jobplace %>% 
  select("Program", "Institution Set Standard", "Stretch Goal", 
         "2018-2019", "2019-2020", "2020-2021") %>% 
  flextable() %>%
  flextable::set_formatter("Institution Set Standard" = function(x) sprintf("%.001f%%", x*100)) %>%
  flextable::set_formatter("Stretch Goal" = function(x) sprintf("%.000f%%", x*100)) %>%
  flextable::set_formatter("2018-2019" = function(x) sprintf("%.000f%%", x*100)) %>% 
  flextable::set_formatter("2019-2020" = function(x) sprintf("%.000f%%", x*100)) %>% 
  flextable::set_formatter("2020-2021" = function(x) sprintf("%.000f%%", x*100)) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width=1.1) %>% 
  set_caption("Job Placement Rates", autonum = run_autonum(seq_id='tab', bkm='cert')) %>%
  footnote(j=1, value = as_paragraph("Source: ACCJC Annual Reports"), ref_symbols=c(""), part = "header") %>% 
  footnote(j=1, value = as_paragraph("Note that data is only available for 2018-2019 and years after."), ref_symbols=c(""), part = "header")


```
