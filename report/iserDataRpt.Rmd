---
title: "ISER Data Section"
author: "Office of Reserach, Planning and Institutional Effectiveness"
date: "`r Sys.Date()`"
output: word_document
    
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(flextable)
library(officer)

load("../is_standards.RData")
load("../entable.RData")
load("../jobs.RData")
load("../demo.RData")
load("../labor_data.RData")
set_flextable_defaults(font.size = 9)

```


# Introduction

## College History

[Provide a brief history of the institution, including year of establishment. Highlight major events or developments that have occurred since the last comprehensive review.]

## Student Enrollment Data 

[Provide tables/charts summarizing enrollment trends. Disaggregate the data as appropriate for the institution’s mission and service area. Provide brief context if needed.] 


```{r, ft.align='left'}
annual %>% 
  flextable() %>% 
  set_caption("Annual Student Metrics", 
              autonum = run_autonum(seq_id='tab', bkm='hc')) %>% 
  footnote(j=1, value=as_paragraph("Source: CCC Chancellor's Office Data Mart"),
           ref_symbols=c(""), part = "header") %>% 
  width(j=1, width=2)
```


```{r, ft.align='left'}
fall_hc %>% 
  #pivot_wider(names_from="Academic Year", values_from = "Headcount") %>% 
  flextable() %>% 
  set_caption("Unduplicated Overall Headcount, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='fhc')) %>% 
  footnote(j=1, value=as_paragraph("Source: CCC Chancellor's Office Data Mart"),
           ref_symbols=c(""), part = "header") %>% 
  width(width=3.2)
```

```{r, ft.align='left'}
fall_cred_hc %>% 
  #pivot_wider(names_from="Academic Year", values_from = "Headcount") %>% 
  flextable() %>% 
  set_caption("Unduplicated Credit Headcount, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='fchc')) %>% 
  footnote(j=1, value=as_paragraph("Source: CCC Chancellor's Office Data Mart"),
           ref_symbols=c(""), part = "header") %>% 
  width(width=3.2)

```

```{r, ft.align='left'}
fall_type_hc %>% 
  pivot_wider(names_from="Fall Term", values_from = "Headcount") %>% 
  flextable() %>% 
  set_caption("Unduplicated Credit Headcount by Student Type, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='fthc')) %>% 
  footnote(j=1, value=as_paragraph("Source: CCC Chancellor's Office Data Mart"),
           ref_symbols=c(""), part = "header") %>% 
  width(j=1, width=2)

```

```{r, ft.align='left'}
fall_goal_hc1 %>% 
  #pivot_wider(names_from="Fall Term", values_from = "Headcount") %>% 
  flextable() %>% 
  set_caption("Unduplicated Credit Headcount by Student Goal, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='fghc')) %>% 
  footnote(j=1, value=as_paragraph("Source: CCC Chancellor's Office Data Mart"),
           ref_symbols=c(""), part = "header") %>% 
  width(j=1, width=2)

```

```{r, ft.align='left'}
fall_gender_hc %>% 
  pivot_wider(names_from="Fall Term", values_from = "Headcount") %>% 
  flextable() %>% 
  set_caption("Unduplicated Credit Headcount by Gender, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='fgehc')) %>% 
  footnote(j=1, value=as_paragraph("Source: CCC Chancellor's Office Data Mart"),
           ref_symbols=c(""), part = "header") %>% 
  width(width=1)
```


```{r, ft.align='left'}
fall_race_hc %>% 
  pivot_wider(names_from="Fall Term", values_from = "Headcount") %>% 
  flextable() %>% 
  set_caption("Unduplicated Credit Headcount by Race/Ethnicity, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='frhc')) %>% 
  footnote(j=1, value=as_paragraph("Source: CCC Chancellor's Office Data Mart"),
           ref_symbols=c(""), part = "header") %>% 
  width(width=1)

```

```{r, ft.align='left'}
fall_age_hc %>% 
  pivot_wider(names_from="Fall Term", values_from = "Headcount") %>% 
  flextable() %>% 
  set_caption("Unduplicated Credit Headcount by Age, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='fahc')) %>% 
  footnote(j=1, value=as_paragraph("Source: CCC Chancellor's Office Data Mart"),
           ref_symbols=c(""), part = "header") %>% 
  width(width=1)
```



```{r, ft.align='left'}
sp_hc %>% flextable() %>% 
  set_caption("Unduplicated Headcount of Special Populations, Fall Terms", 
              autonum = run_autonum(seq_id='tab', bkm='special')) %>% 
  footnote(j=1, value=as_paragraph("Source: CCC Chancellor's Office Data Mart"),
           ref_symbols=c(""), part = "header") %>% 
  width(j=1, width=2.75)
```


## Labor Market Data 

[Provide summary-level labor market data for the service area. Disaggregate the data as appropriate for the institution’s mission and service area. Provide brief context if needed.] 

At a broad level, the top industries in the Greater Bay Area are Health Care and Social Assistance and Professional, Scientific, and Technical Services (Reference table).

```{r, ft.align='left'}
broad_ten %>% flextable() %>% 
  flextable::set_formatter("Share of Total Employment" = function(x) sprintf("%.001f%%", x*100)) %>% 
  set_caption("Top Industries by Employment (Greater Bay Area, 2020 Q3)", autonum = run_autonum(seq_id='tab', bkm='broadten')) %>% 
  footnote(j=1, value = as_paragraph("Source: JobsEQ, via Hanover Research"), ref_symbols=c(""), part = "header") %>% 
  width(j=1, width = 4.5) %>% 
  width(j=2, width=2)
```

More than 10 percent of workers are employed in each of these two broad industries. At a more detailed level, employment after restaurants is concentrated in several high tech industries, schools, and hospitals (reference the top industries by employment table). 

```{r, ft.align="left"}
topten %>% flextable::flextable() %>% 
  flextable::set_formatter("Share of Total Employment" = function(x) sprintf("%.001f%%", x*100)) %>% 
  width(j=1, width = 4.5) %>% 
  width(j=2, width=2) %>% 
  set_caption("Top Industries by Employment  (Greater Bay Area, 2020 Q3)", autonum = run_autonum(seq_id='tab', bkm='topten')) %>% 
  footnote(j=1, value = as_paragraph("Source: JobsEQ, via Hanover Research"), ref_symbols=c(""), part = "header")
```

All top 10 Bay Area tech industries by share of employment have positive 10-year projected growth (reference table). Also, the Greater Bay Area is projected to have an employment undersupply for occupations in business, technology, and healthcare including software developers, nurses, and managers while it is also projected to have a slight oversupply for teaching related occupations and paralegals/legal assistants. 

<!-- please add another table from pg 16 regarding top bay area occupation gaps 2020-2030. Can you also figure out what "Two-Year Degree or higher only" means here? My guess is that the data is among those with two year degree or higher? Also, are these referring to the numbers of persons with the necessary credentials to work in these positions?    -->

```{r, ft.align='left'}
gaps %>% flextable() %>% 
  width(j=1, width = 5) %>% 
  set_caption("Occupation Gaps over 10 Years in Greater Bay Area, Two-Year Degree or Higher Only", autonum = run_autonum(seq_id='tab', bkm='gaps')) %>% 
  footnote(j=1, value = as_paragraph("Source: JobsEQ, via Hanover Research"), ref_symbols=c(""), part = "header") %>% 
  footnote(j=1, value = as_paragraph("Note that this list only includes occupations that require at minimum a two-year (Associate's) degree."), ref_symbols=c(""), part = "header")

```



```{r, ft.align="left"}
toptech %>% flextable::flextable() %>% 
  set_caption("Top Bay Area Tech Industries  (Greater Bay Area, 2020 Q3)", autonum = run_autonum(seq_id='tab', bkm='toptech')) %>% 
  flextable::set_formatter("Projected Growth, 2020-2030" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("Share of Total Employment" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_table_properties(width = .5, layout='autofit') %>% 
  footnote(j=1, value = as_paragraph("Source: JobsEQ, via Hanover Research"), ref_symbols=c(""), part = "header")

```
```{r, ft.align="left"}
most_openings %>% select(-"Unemployment") %>% 
  flextable::flextable() %>% 
  set_caption("Occupations with the Most Job Openings", autonum = run_autonum(seq_id='tab', bkm='openings')) %>% 
  flextable::set_table_properties(width = .5, layout='autofit') %>% 
  footnote(j=1, value = as_paragraph("Source: JobsEQ, via Hanover Research"), ref_symbols=c(""), part = "header")

```

```{r, ft.align="left"}
most_growth %>% select(-"Unemployment") %>% 
  flextable::flextable() %>% 
  flextable::set_formatter("% Change" = function(x) sprintf("%.001f%%", x*100)) %>%
  set_caption("Fastest Growing Occupations",autonum = run_autonum(seq_id='tab', bkm='topten')) %>% 
  width(j=1, width = 5) %>% 
  footnote(j=1, value = as_paragraph("Source: JobsEQ, via Hanover Research"), ref_symbols=c(""), part = "header")


```


## Demographic Data 

[Provide summary-level demographic data for the service area. Disaggregate the data as appropriate for the institution’s mission and service area. Provide brief context if needed.] 


```{r, ft.align="left"}
projections %>% 
  pivot_wider(names_from = years, values_from = population) %>% 
  flextable::flextable() %>% 
  set_caption("Bay Area Population Projections", autonum = run_autonum(seq_id='tab', bkm='popproj')) %>% 
  width(width=1.05) %>% 
  footnote(j=1, value = as_paragraph("Source: State of California Department of Finance, via Hanover Research"), ref_symbols=c(""), part = "header")
```


```{r, ft.align="left"}
raceproj %>% 
  flextable::flextable() %>% 
  set_caption("Bay Area Population Projections by Race/Ethnicity",autonum = run_autonum(seq_id='tab', bkm='rproj')) %>% 
  flextable::set_formatter("2020" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2060" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("Percent Change" = function(x) sprintf("%.001f%%", x*100)) %>% 
  width(width=1.6) %>% 
  footnote(j=1, value = as_paragraph("Source: State of California Department of Finance, via Hanover Research"), ref_symbols=c(""), part = "header")

```

```{r, ft.align="left"}
race %>% flextable::flextable() %>% 
    flextable::set_caption("Service Area Racial Breakdown",autonum = run_autonum(seq_id='tab', bkm='race')) %>%     flextable::set_formatter("Bay Area: Percent" = function(x) sprintf("%.001f%%", x*100)) %>% 
    flextable::set_formatter("SC County: Percent" = function(x) sprintf("%.001f%%", x*100))%>% 
  flextable::set_table_properties(width = .5, layout='autofit') %>% 
  footnote(j=1, value = as_paragraph("Source: US Census Bureau, via Hanover Research"), ref_symbols=c(""), part = "header")

```

```{r, ft.align="left"}
  ethnicity %>% flextable::flextable() %>% 
    set_caption("Service Area Ethnicity Breakdown",autonum = run_autonum(seq_id='tab', bkm='ethn')) %>% 
    flextable::set_formatter("Bay Area: Percent" = function(x) sprintf("%.001f%%", x*100)) %>% 
    flextable::set_formatter("SC County: Percent" = function(x) sprintf("%.001f%%", x*100))%>% 
    flextable::set_table_properties(width = .5, layout='autofit') %>% 
    footnote(j=1, value = as_paragraph("Source: US Census Bureau, via Hanover Research"), ref_symbols=c(""), part = "header")

```




## Socio-economic Data 

[Provide summary-level socio-economic data for the service area. Disaggregate the data as appropriate for the institution’s mission and service area. Provide brief context if needed.] 

```{r, ft.align="left"}
education %>% 
  flextable::flextable() %>% 
  set_caption("Educational Attainment for Population Age 25+",autonum = run_autonum(seq_id='tab', bkm='edatt')) %>% 
  flextable::set_formatter("Bay Area: Percent" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("SC County: Percent" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_table_properties(width = .5, layout='autofit') %>% 
  footnote(j=1, value = as_paragraph("Source: US Census Bureau, via Hanover Research"), ref_symbols=c(""), part = "header")


```


```{r, ft.align="left"}
median[1,1] <- "Median Income (dollars)"
median %>% 
  flextable::flextable() %>% 
  set_caption("Income in the Service Area",autonum = run_autonum(seq_id='tab', bkm='income')) %>% 
  width(width=1.5) %>% 
    footnote(j=1, value = as_paragraph("Source: US Census Bureau, via Hanover Research"), ref_symbols=c(""), part = "header")

```


```{r, ft.align='left'}
poverty %>% flextable() %>%
    flextable::set_formatter("Greater Bay Area" = function(x) sprintf("%.001f%%", x*100)) %>% 
    flextable::set_formatter("Santa Clara County" = function(x) sprintf("%.001f%%", x*100)) %>% 
    set_caption("Poverty Level in the Service Area",autonum = run_autonum(seq_id='tab', bkm='poverty')) %>% 
  width(width=1.5) %>% 
  footnote(j=1, value = as_paragraph("Source: US Census Bureau, via Hanover Research"), ref_symbols=c(""), part = "header")

```


## Sites 

[List names and locations (including addresses) of sites where 50% or more of a program, certificate, or degree is available to students, and any other off-campus sites or centers.] 

## Specialized or Programmatic Accreditation 

[Provide a list of any specialized or programmatic accreditations held by the institution.] 

# Presentation of Student Achievement Data and Institution-Set Standards 


```{r, ft.align='left'}
desc <- overallcs$description[1]
overallcs %>% 
  select(years, Type, percentage) %>% 
  pivot_wider(names_from = years, values_from = percentage) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::set_formatter("2016-2017" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2017-2018" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2018-2019" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2019-2020" = function(x) sprintf("%.001f%%", x*100)) %>% 
  width(width = 1.3) %>% 
  set_caption("Overall Course Success Rate",autonum = run_autonum(seq_id='tab', bkm='cso')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```

```{r, ft.align='left'}
title <- "Distinct number of CO-approved certificate earners (12+ units)"
overall603 %>% 
  select(years, Type, value) %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width=1.3) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='cert')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```


```{r, ft.align='left'}
title <- "Distinct number of degree earners (AA, AS, or ADT) "
overall631 %>% 
  select(years, Type, value) %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width=1.3) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='deg')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")
```

```{r, ft.align='left'}
title <- "Distinct number of ADT earners"
overall608 %>% 
  select(years, Type, value) %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width=1.3) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='adt')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```


```{r, ft.align='left'}
title <- "Distinct number of transfers to CSU or UC"
overall614 %>% 
  select(years, Type, value) %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width=1.1) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='csuuc')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")
```
## Disaggregation by Gender


```{r, ft.align='left'}
title <- "Course Success Rates by Gender"
desc <- "Note: \"All Masked Values\" contains Non-Binary and Unknown/Non-Respondent students."
csgender %>% 
  select(years, Gender, value) %>% 
  drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::set_formatter("2016-2017" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2017-2018" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2018-2019" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2019-2020" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1.3) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='csg')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")
```

```{r, ft.align='left'}
title <- "Certificate Earners by Gender"
desc <- "Note: \"All Masked Values\" contains Non-Binary and Unknown/Non-Respondent students."
ggrads603 %>% 
  select(years, Gender, value) %>% 
  drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width=1.3) %>% 
  flextable::add_footer_lines(values = desc) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='certg')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```


```{r, ft.align='left'}
title <- "Degree Earners by Gender"
desc <- "Note: \"All Masked Values\" contains Non-Binary and Unknown/Non-Respondent students."
ggrads631%>% 
  select(years, Gender, value) %>% 
  drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1.3) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='degg')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```

```{r, ft.align='left'}
title <- "ADT Earners by Gender"
desc <- "Note: \"All Masked Values\" contains Non-Binary and Unknown/Non-Respondent students."
ggrads608%>% 
  select(years, Gender, value) %>% 
  drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1.3) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='adtg')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```


```{r, ft.align='left'}
title <- "Distinct Number of Transfers to CSU or UC by Gender"
desc <- "Note: \"All Masked Values\" contains Non-Binary and Unknown/Non-Respondent students."
ggrads614 %>% 
  select(years, Gender, value) %>% 
  filter(Gender=="Female" | Gender=="Male" | Gender=="All Masked Values") %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1.075) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='csuucg')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```
## Disaggregation by Ethnicity

```{r, ft.align='left'}
title <- "Course Success Rates by Ethnicity"
desc <- "Note: \"All Masked Values\" contains students who listed another ethnicity or did not respond."
csrace %>% 
  select(years, Ethnicity, value) %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  drop_na() %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::set_formatter("2016-2017" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2017-2018" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2018-2019" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::set_formatter("2019-2020" = function(x) sprintf("%.001f%%", x*100)) %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1.3) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='cse')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```


```{r, ft.align='left'}
title <- "Certificate Earners by Ethnicity"
desc <- "Note: \"All Masked Values\" contains students who listed another ethnicity or did not respond."
rgrads603 %>% 
  select(years, Ethnicity, value) %>% 
  #drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width=1.3) %>% 
  flextable::add_footer_lines(values = desc) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='certe')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")
```


```{r, ft.align='left'}
title <- "Degree Earners by Ethnicity"
desc <- "Note: \"All Masked Values\" contains students who listed another ethnicity or did not respond."
rgrads631%>% 
  select(years, Ethnicity, value) %>% 
  #drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1.3) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='dege')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")
```


```{r, ft.align='left'}
title <- "ADT Earners by Ethnicity"
desc <- "Note: \"All Masked Values\" contains students who listed another ethnicity or did not respond."
rgrads608%>% 
  select(years, Ethnicity, value) %>% 
  #drop_na() %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1.3) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='adte')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```


```{r, ft.align='left'}
title <- "Distinct Number of Transfers to CSU or UC by Ethnicity"
desc <- "Note: \"All Masked Values\" contains students who listed another ethnicity or not respond."
rgrads614 %>% 
  select(years, Ethnicity, value) %>% 
  pivot_wider(names_from = years, values_from = value) %>% 
  flextable::flextable() %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::add_footer_lines(values = desc) %>% 
  flextable::width(width=1.1) %>% 
  set_caption(title, autonum = run_autonum(seq_id='tab', bkm='csuuce')) %>%
  footnote(j=1, value = as_paragraph("Source: Student Success Metrics"), ref_symbols=c(""), part = "header")

```

## Licensure Pass and Job Placement Rates

```{r licensure, ft.align='left'}
licensure %>% 
  select("Program", "Exam Type", "Institution Set Standard", "Stretch Goal", 
         "2016-2017", "2017-2018", "2018-2019", "2019-2020", "2020-2021") %>% 
  flextable::flextable() %>% 
  flextable::set_table_properties(width = .5, layout='autofit') %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::set_formatter("Institution Set Standard" = function(x) sprintf("%.001f%%", x*100)) %>%
  flextable::set_formatter("Stretch Goal" = function(x) sprintf("%.000f%%", x*100)) %>%
  flextable::set_formatter("2016-2017" = function(x) sprintf("%.000f%%", x*100)) %>% 
  flextable::set_formatter("2017-2018" = function(x) sprintf("%.000f%%", x*100)) %>% 
  flextable::set_formatter("2018-2019" = function(x) sprintf("%.000f%%", x*100)) %>% 
  flextable::set_formatter("2019-2020" = function(x) sprintf("%.000f%%", x*100)) %>% 
  flextable::set_formatter("2020-2021" = function(x) sprintf("%.000f%%", x*100)) %>% 
  footnote(i=4, j=8, value = as_paragraph("No campus specific data on this item."), ref_symbols = c("A"), part = "body") %>%  
  footnote(i=5, j=8, value = as_paragraph("No one took the exam this year due to Covid"), ref_symbols = c("B"), part = "body") %>% 
  set_caption("Licensure Pass Rates", autonum = run_autonum(seq_id='tab', bkm='cert')) %>%
  footnote(j=1, value = as_paragraph("Source: "), ref_symbols=c(""), part = "header")


```


```{r job placement, ft.align='left'}
  jobplace %>% 
    flextable::flextable() %>%
    flextable::set_formatter("Institution Set Standard" = function(x) sprintf("%.001f%%", x*100)) %>%
  flextable::set_formatter("Stretch Goal" = function(x) sprintf("%.000f%%", x*100)) %>%
  flextable::set_formatter("2018-2019" = function(x) sprintf("%.000f%%", x*100)) %>% 
  flextable::set_formatter("2019-2020" = function(x) sprintf("%.000f%%", x*100)) %>% 
  flextable::set_formatter("2020-2021" = function(x) sprintf("%.000f%%", x*100)) %>% 
  flextable::align(i=1, align="center", part="header") %>% 
  flextable::width(width=1.1) %>% 
  set_caption("Job Placement Rates", autonum = run_autonum(seq_id='tab', bkm='cert')) %>%
  footnote(j=1, value = as_paragraph("Source: "), ref_symbols=c(""), part = "header")

```
